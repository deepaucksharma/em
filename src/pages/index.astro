---
import BaseLayout from '../layouts/BaseLayout.astro';
import StatsBar from '../components/ui/StatsBar.astro';
import CapabilityCard from '../components/cards/CapabilityCard.astro';
import AntiPatternCard from '../components/cards/AntiPatternCard.astro';
import PlaybookCard from '../components/cards/PlaybookCard.astro';
import { capabilities, observables, antiPatterns, playbooks, calibrationSignals, interviewQuestions } from '../lib/data';
import { DOMAIN_ORDER, getDomainColor } from '../lib/utils';

const stats = [
  { value: capabilities.length, label: 'Capabilities', href: '/capabilities/' },
  { value: observables.length, label: 'Observables', href: '/capabilities/' },
  { value: playbooks.length, label: 'Playbooks', href: '/playbooks/' },
  { value: interviewQuestions.length, label: 'Interview Questions', href: '/interview-questions/' },
];

const capsByDomain = DOMAIN_ORDER.map(domain => ({
  domain,
  capabilities: capabilities.filter(c => c.domain === domain),
}));

const featuredPlaybooks = playbooks.slice(0, 6);
const featuredAntiPatterns = antiPatterns.slice(0, 6);
---

<BaseLayout title="Home">
  <!-- Hero -->
  <section class="relative bg-gradient-to-br from-blue-50 via-indigo-50/50 to-white dark:from-gray-800 dark:via-slate-800 dark:to-gray-900 border-b border-gray-200 dark:border-gray-800 overflow-hidden">
    <div class="hero-pattern absolute inset-0 pointer-events-none"></div>
    <!-- Decorative geometric element -->
    <svg class="absolute right-0 top-0 h-full w-1/2 opacity-[0.06] dark:opacity-[0.04] pointer-events-none" viewBox="0 0 400 400" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="300" cy="100" r="120" stroke="currentColor" stroke-width="1.5" class="text-blue-600 dark:text-blue-400" />
      <rect x="200" y="180" width="160" height="160" rx="12" stroke="currentColor" stroke-width="1.5" class="text-indigo-500 dark:text-indigo-400" />
      <polygon points="100,350 180,250 260,350" stroke="currentColor" stroke-width="1.5" fill="none" class="text-blue-500 dark:text-blue-300" />
      <line x1="50" y1="50" x2="350" y2="50" stroke="currentColor" stroke-width="1" class="text-gray-400 dark:text-gray-600" />
      <line x1="50" y1="400" x2="50" y2="100" stroke="currentColor" stroke-width="1" class="text-gray-400 dark:text-gray-600" />
    </svg>
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24">
      <div class="max-w-3xl">
        <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white tracking-tight mb-4">
          Engineering Leadership Matrix
        </h1>
        <p class="text-xl text-gray-600 dark:text-gray-400 mb-2">
          Version 6 — EM &amp; Director at Big Tech
        </p>
        <p class="text-lg text-gray-500 dark:text-gray-400 mb-8">
          A unified capability model with {capabilities.length} capabilities, {observables.length} observables,
          {antiPatterns.length} anti-patterns, and {playbooks.length} scenario playbooks — designed for
          career conversations, 1:1s, and calibration.
        </p>
        <div class="flex flex-wrap gap-3">
          <a href="/capabilities/" class="inline-flex items-center px-5 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors">
            Explore Capabilities
          </a>
          <a href="/rubric/" class="inline-flex items-center px-5 py-2.5 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
            View Rubric
          </a>
        </div>
      </div>
    </div>
  </section>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Stats -->
    <section class="-mt-8 mb-16 relative z-10">
      <StatsBar stats={stats} />
    </section>

    <!-- Capabilities by Domain -->
    <section class="mb-16">
      <h2 class="section-heading">Capabilities by Domain</h2>
      {capsByDomain.map(({ domain, capabilities: caps }) => (
        <div class="mb-10">
          <div class="flex items-center gap-3 mb-4">
            <h3 class:list={['text-lg font-semibold', getDomainColor(domain).text]}>{domain}</h3>
            <a href={`/domains/${domain.toLowerCase()}/`} class="text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
              View all &rarr;
            </a>
          </div>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            {caps.map(cap => (
              <CapabilityCard capability={cap} />
            ))}
          </div>
        </div>
      ))}
    </section>

    <!-- Featured Playbooks -->
    <section class="mb-16">
      <div class="flex items-center justify-between mb-6">
        <h2 class="section-heading mb-0">Scenario Playbooks</h2>
        <a href="/playbooks/" class="text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300">
          View all {playbooks.length} &rarr;
        </a>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        {featuredPlaybooks.map(pb => (
          <PlaybookCard playbook={pb} />
        ))}
      </div>
    </section>

    <!-- Featured Anti-Patterns -->
    <section class="mb-16">
      <div class="flex items-center justify-between mb-6">
        <h2 class="section-heading mb-0">Anti-Patterns</h2>
        <a href="/anti-patterns/" class="text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300">
          View all {antiPatterns.length} &rarr;
        </a>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        {featuredAntiPatterns.map(ap => (
          <AntiPatternCard antiPattern={ap} />
        ))}
      </div>
    </section>

    <!-- Quick Links -->
    <section class="mb-16">
      <h2 class="section-heading">Quick Links</h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <a href="/learning-pathways/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Learning Pathways</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Books, workshops, and exercises for every capability</p>
        </a>
        <a href="/self-assessment/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15a2.25 2.25 0 012.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0118 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3l1.5 1.5 3-3.75" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Self-Assessment</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Rate yourself 1-5 across all capabilities</p>
        </a>
        <a href="/career-progression/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Career Progression</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">EM to VP — scope, expectations, promotion blockers</p>
        </a>
        <a href="/interview-questions/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Interview Questions</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">{interviewQuestions.length} questions with follow-ups and red flags</p>
        </a>
        <a href="/rubric/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0112 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 0v1.5c0 .621-.504 1.125-1.125 1.125m1.125-2.625c-.621 0-1.125.504-1.125 1.125" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Rubric Overview</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">3-level behavioral anchors for all capabilities</p>
        </a>
        <a href="/calibration/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 12.75c1.148 0 2.278.08 3.383.237 1.037.146 1.866.966 1.866 2.013 0 3.728-2.35 6.75-5.25 6.75S6.75 18.728 6.75 15c0-1.046.83-1.867 1.866-2.013A24.204 24.204 0 0112 12.75zm0 0c2.883 0 5.647.508 8.207 1.44a23.91 23.91 0 01-1.152 6.06M12 12.75c-2.883 0-5.647.508-8.208 1.44.125 2.104.52 4.136 1.153 6.06M12 12.75a2.25 2.25 0 002.248-2.354M12 12.75a2.25 2.25 0 01-2.248-2.354M12 8.25c.995 0 1.971-.08 2.922-.236.403-.066.74-.358.795-.762a3.778 3.778 0 00-.399-2.25M12 8.25c-.995 0-1.97-.08-2.922-.236-.402-.066-.74-.358-.795-.762a3.734 3.734 0 01.4-2.253M12 8.25a2.25 2.25 0 00-2.248 2.146M12 8.25a2.25 2.25 0 012.248 2.146M8.683 5a6.032 6.032 0 01-1.155-1.002c.07-.63.27-1.222.574-1.747m.581 2.749A3.75 3.75 0 0115.318 5m0 0c.427-.283.815-.62 1.155-.999a4.471 4.471 0 00-.575-1.752M4.921 6a24.048 24.048 0 00-.392 3.314c1.668.546 3.416.914 5.223 1.082M19.08 6c.205 1.08.337 2.187.392 3.314a23.882 23.882 0 01-5.223 1.082" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Calibration Signals</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">{calibrationSignals.length} signals for promo packets &amp; reviews</p>
        </a>
        <a href="/org-maturity/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3H21m-3.75 3H21" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Org Maturity Model</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">5-level maturity assessment for engineering orgs</p>
        </a>
        <a href="/measurement-guide/" class="card group block text-center">
          <svg class="w-8 h-8 text-blue-500 dark:text-blue-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6a7.5 7.5 0 107.5 7.5h-7.5V6z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 10.5H21A7.5 7.5 0 0013.5 3v7.5z" />
          </svg>
          <h3 class="font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">Measurement Guide</h3>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Leading and lagging indicators per capability</p>
        </a>
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .hero-pattern {
    background-image: radial-gradient(circle, #3b82f620 1px, transparent 1px);
    background-size: 24px 24px;
  }
  :global(.dark) .hero-pattern {
    background-image: radial-gradient(circle, #3b82f610 1px, transparent 1px);
  }
</style>
