---
import Badge from '../ui/Badge.astro';
import type { Capability } from '../../lib/data';
import { getCoverage } from '../../lib/data';
import { formatPercent } from '../../lib/utils';
import { url } from '../../lib/url';

interface Props {
  capability: Capability;
}

const { capability } = Astro.props;
const cov = getCoverage(capability.id);
---

<a href={url(`/capabilities/${capability.slug}/`)} class="card group block">
  <div class="flex items-start justify-between mb-3">
    <Badge text={capability.domain} variant="domain" domain={capability.domain} />
    <span class="text-xs font-mono text-gray-400 dark:text-gray-500">{capability.id}</span>
  </div>
  <h3 class="text-lg font-semibold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors mb-2">
    {capability.name}
  </h3>
  <p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-2 mb-4">
    {capability.description}
  </p>
  <div class="flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400">
    <span>{capability.observableCount} observables</span>
    {cov && <span title="Percentage of primary sub-topics covered by observables">{formatPercent(cov.coveragePercent)} coverage</span>}
  </div>
</a>
